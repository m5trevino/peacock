# Peacock System Code Debugging
**Date:** 2025-06-11 23:47:20
**UUID:** 7499132e-f466-4f24-ae24-fbd0ddf8daf9

============================================================
[USER ENTRY #001] - 2025-06-11 23:47:21
============================================================

please study this in my project knowedge ...
make sure to review everything listed + more 
when your done... 
do it one more time!


end of last session - info from out last chat 
merged_content.txt - my current code
ğŸ¦š Peacock Complete System Breakdown - Session Handoff.md - a good breakdown from a week ago
Comprehensive Peacock Testing Results Analysis.md - api testing analysis 
ğŸ¦š Final pea-mcp.py - Complete Working Version.txt - this was my pea-mcp when it was working perfectly (before the modualization of the app)
/home/flintx/peacock/core/xedit.py (latest) - working - (before the modualization of the app)
/home/flintx/peacock/core/1prompt.py (latest) workinf - (before the modualization of the app)
/home/flintx/peacock/core/pea-mcp.py (latest) - working - (before the modualization of the app)
Peacock LLM Output Parsing Strategy - The Real Blueprint.md - how to parse responses!!!! 

here is my dir structure. 

â””â”€âš¡  tree
.
â”œâ”€â”€ aviary
â”‚Â Â  â”œâ”€â”€ eagle.py
â”‚Â Â  â”œâ”€â”€ falcon.py
â”‚Â Â  â”œâ”€â”€ hawk.py
â”‚Â Â  â”œâ”€â”€ in_homing.py
â”‚Â Â  â”œâ”€â”€ **init**.py
â”‚Â Â  â”œâ”€â”€ out_homing.py
â”‚Â Â  â”œâ”€â”€ **pycache**
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ eagle.cpython-312.pyc
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ falcon.cpython-312.pyc
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ hawk.cpython-312.pyc
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ in_homing.cpython-312.pyc
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ out_homing.cpython-312.pyc
â”‚Â Â  â”‚Â Â  â”œâ”€â”€ spark.cpython-311.pyc
â”‚Â Â  â”‚Â Â  â””â”€â”€ spark.cpython-312.pyc
â”‚Â Â  â””â”€â”€ spark.py
â”œâ”€â”€ core
â”‚Â Â  â”œâ”€â”€ 1prompt.py
â”‚Â Â  â”œâ”€â”€ pea-mcp.py
â”‚Â Â  â”œâ”€â”€ pefa-mcp.py
â”‚Â Â  â”œâ”€â”€ **pycache**
â”‚Â Â  â”‚Â Â  â””â”€â”€ xedit.cpython-312.pyc
â”‚Â Â  â””â”€â”€ xedit.py
â”œâ”€â”€ html
â”‚Â Â  â”œâ”€â”€ 1prompt-dashboard-24-11-1348.html
â”‚Â Â  â”œâ”€â”€ 1prompt-dashboard-24-11-1357.html
â”‚Â Â  â””â”€â”€ 1prompt-dashboard-24-11-1401.html
â””â”€â”€ logs
7 directories, 22 files
(peacock)  flintxğŸ’€flintx î‚° ~/peacock î‚° ğŸŒ¿ main â— 




current error is 
â””â”€âš¡  python3 pea-mcp.py --log
  File "/home/flintx/peacock/core/pea-mcp.py", line 498
    global LOGGING_ENABLED
    ^^^^^^^^^^^^^^^^^^^^^^
SyntaxError: name 'LOGGING_ENABLED' is used prior to global declaration
(peacock)  âœ˜ flintxğŸ’€flintx î‚° ~/peacock/core î‚° ğŸŒ¿ main â—

------------------------------------------------------------
[CLAUDE RESPONSE #001] - 2025-06-11 23:47:55
------------------------------------------------------------

 What up G! 4sho, let me dive deep into your project knowledge and see what the fuck is goin' on with your Peacock system. Let me study all this shit real proper like.
```
This block is not supported on your current device yet.
```

Yo, let me check the exact syntax error happening:
```
This block is not supported on your current device yet.
```

Ah shit! I see the problem now. Looking at the pea-mcp-marked-8.py, the issue is that you have a broken main function with both old and new code mixed together. 

Here's the fixed `main()` function block - **replace everything between the markers**:

```python
def main():
    """Main server startup with FULL CYBERPUNK EXPERIENCE"""
    parser = argparse.ArgumentParser(description='Peacock MCP Server - Cyberpunk Edition')
    parser.add_argument('--log', action='store_true', help='Enable comprehensive logging')
    parser.add_argument('--port', type=int, default=8000, help='Server port (default: 8000)')
    
    args = parser.parse_args()
    
    global LOGGING_ENABLED
    LOGGING_ENABLED = args.log
    server_port = args.port
    
    # Create logs directory
    if LOGGING_ENABLED:
        Path("/home/flintx/peacock/logs").mkdir(parents=True, exist_ok=True)
    
    # Initial setup messages (minimal)
    print(f"{CyberStyle.DIM}ğŸ”§ Initializing Peacock MCP Server...{CyberStyle.RESET}")
    print(f"{CyberStyle.DIM}ğŸ“Š Logging: {'Enabled' if LOGGING_ENABLED else 'Disabled'}{CyberStyle.RESET}")
    print(f"{CyberStyle.DIM}ğŸ“… Session: {SESSION_TIMESTAMP}{CyberStyle.RESET}")
    print()
    
    try:
        with socketserver.TCPServer((HOST, server_port), CyberpunkRequestHandler) as httpd:
            # NOW SHOW THE SICK BANNER - RIGHT BEFORE SERVER STARTS
            show_cyberpunk_banner()
            
            # PAUSE TO LET PEOPLE ADMIRE THE FIRE ASCII ART
            print(f"{CyberStyle.HOT_PINK}ğŸ’€ FLEXING ON THE COMPETITION... ğŸ’€{CyberStyle.RESET}")
            time.sleep(3)  # 3 second pause to show off that sick art
            
            # Display full configuration with style
            print(f"{CyberStyle.NEON_GREEN}ğŸ”§ Primary Model:{CyberStyle.RESET} {CyberStyle.BOLD}{PEACOCK_MODEL_STRATEGY['primary_model']}{CyberStyle.RESET}")
            print(f"{CyberStyle.NEON_CYAN}âš¡ Speed Model:{CyberStyle.RESET} {CyberStyle.BOLD}{PEACOCK_MODEL_STRATEGY['speed_model']}{CyberStyle.RESET}")
            print(f"{CyberStyle.NEON_PURPLE}ğŸ§  Strategy:{CyberStyle.RESET} {CyberStyle.NEON_CYAN}Bird-Specific API Keys + Proxy Fallback{CyberStyle.RESET}")
            print(f"{CyberStyle.ELECTRIC_BLUE}ğŸ“… Session:{CyberStyle.RESET} {CyberStyle.BOLD}{SESSION_TIMESTAMP}{CyberStyle.RESET}")
            print(f"{CyberStyle.NEON_RED}ğŸ“Š Logging:{CyberStyle.RESET} {CyberStyle.NEON_GREEN if LOGGING_ENABLED else CyberStyle.NEON_RED}{'Enabled' if LOGGING_ENABLED else 'Disabled'}{CyberStyle.RESET}")
            print(f"{CyberStyle.NEON_GREEN}ğŸ“ Log Directory:{CyberStyle.RESET} {CyberStyle.BOLD}/home/flintx/peacock/logs{CyberStyle.RESET}")
            print()
            
            # Show the cyberpunk banners for bird loading
            show_cyberpunk_banner_long("ğŸ¦… BIRDS: All bird modules loaded successfully")
            show_cyberpunk_banner_long(f"MCP: Server started on {HOST}:{server_port}")
            
            # Final server ready messages that STAY VISIBLE
            print(f"{CyberStyle.NEON_GREEN}{CyberStyle.BOLD}ğŸš€ Peacock MCP Server ready for requests...{CyberStyle.RESET}")
            print(f"{CyberStyle.NEON_CYAN}{CyberStyle.BOLD}ğŸ“¡ Endpoint: http://{HOST}:{server_port}{PROCESS_PATH}{CyberStyle.RESET}")
            print(f"{CyberStyle.NEON_PURPLE}{CyberStyle.BOLD}ğŸ¯ Commands: peacock_full, deploy_pcock, xedit_fix{CyberStyle.RESET}")
            print(f"{CyberStyle.NEON_YELLOW}{CyberStyle.BOLD}âš¡ Press Ctrl+C to stop{CyberStyle.RESET}")
            print()
            print(f"{CyberStyle.HOT_PINK}{CyberStyle.BOLD}ğŸ’€ CYBERPUNK MODE ACTIVATED - READY TO FLEX ON THE COMPETITION ğŸ’€{CyberStyle.RESET}")
            print()
            
            httpd.serve_forever()
            
    except KeyboardInterrupt:
        print(f"\n{CyberStyle.NEON_RED}ğŸ›‘ Server stopped by user{CyberStyle.RESET}")
        sys.exit(0)
    except Exception as e:
        print(f"{CyberStyle.NEON_RED}âŒ Server error: {str(e)}{CyberStyle.RESET}")
        sys.exit(1)
```

The key fixes:
1. **Removed global PORT declaration** - using local `server_port` variable instead
2. **Fixed function structure** - removed the duplicate/broken code fragments
3. **Kept all the cyberpunk styling** - banner, colors, pause effects

Replace your current `main()` function with this block and it should run clean! ğŸ”¥

============================================================
[USER ENTRY #002] - 2025-06-11 23:56:46
============================================================

there is no markers in the code you just gave me 

the markers look like this 

4-Marker System:
    #â…›Â¼ START OF DOCUMENT â…œ#
    #Â¼Â¼Â¼Â¼Â¼Â¼ 1/4 MARKER Â¼Â¼Â¼Â¼Â¼#
    #Â½Â½Â½Â½Â½Â½ 1/2 MARKER Â½Â½Â½Â½Â½#
    #Â¾Â¾Â¾Â¾Â¾Â¾ 3/4 MARKER Â¾Â¾Â¾Â¾Â¾#
    #â…›Â¼ END OF DOCUMENT â…œ#
8-Marker System:
    #â…›Â¼â…œÂ½ START OF DOCUMENT â…Â¾â…#
    #â…›â…›â…›â…›â…›â…› 1/8 MARKER â…›â…›â…›â…›â…›#
    #Â¼Â¼Â¼Â¼Â¼Â¼ 1/4 MARKER Â¼Â¼Â¼Â¼Â¼#
    #â…œâ…œâ…œâ…œâ…œâ…œ 3/8 MARKER â…œâ…œâ…œâ…œâ…œ#
    #Â½Â½Â½Â½Â½Â½ 1/2 MARKER Â½Â½Â½Â½Â½#
    #â…â…â…â…â…â… 5/8 MARKER â…â…â…â…â…#
    #Â¾Â¾Â¾Â¾Â¾Â¾ 3/4 MARKER Â¾Â¾Â¾Â¾Â¾#
    #â…â…â…â…â…â… 7/8 MARKER â…â…â…â…â…#
    #â…›Â¼â…œÂ½ END OF DOCUMENT â…Â¾â…#

------------------------------------------------------------
[CLAUDE RESPONSE #002] - 2025-06-11 23:57:22
------------------------------------------------------------

 Ah shit, my bad G! You need the markers so you can find the exact section to replace. Let me search for the markers in your pea-mcp-marked-8.py:
```
This block is not supported on your current device yet.
```

Looking at your latest merged content, I need to find the specific function causing the global declaration issue. Let me search for the exact main function:
```
This block is not supported on your current device yet.
```

Yooooo! Looking at your paste.txt, I see what happened. You got a mess of duplicated code that's breaking the syntax. 

Here's the CLEAN version from the **Â½Â½Â½Â½Â½Â½ 1/2 MARKER Â½Â½Â½Â½Â½#** to the end:

```python
#Â½Â½Â½Â½Â½Â½ 1/2 MARKER Â½Â½Â½Â½Â½#

                response_json = json.dumps(result, indent=2)
                response_log = (
                    f"\n{'='*80}\n"
                    f"TIMESTAMP: {datetime.datetime.now().isoformat()}\n"
                    f"RESPONSE ({len(response_json)} bytes):\n{response_json}"
                    f"\n{'='*80}"
                )
                log_to_file('response', response_log)

                # Send response
                self.send_response(200)
                self.send_header("Content-type", "application/json")
                self.send_header("Access-Control-Allow-Origin", "*")
                self.end_headers()
                
                self.wfile.write(response_json.encode("utf-8"))
                
                cli_progress("MCP", "SUCCESS", f"Response sent: {len(response_json)} bytes")

            except Exception as e:
                error_msg = f"Server error: {str(e)}"
                cli_progress("MCP", "ERROR", error_msg)
                
                # Log the full error with traceback
                import traceback
                error_log = (
                    f"\n{'='*80}\n"
                    f"TIMESTAMP: {datetime.datetime.now().isoformat()}\n"
                    f"ERROR: {error_msg}\n"
                    f"TRACEBACK:\n{traceback.format_exc()}"
                    f"\n{'='*80}"
                )
                log_to_file('error', error_log)
                
                self.send_response(500)
                self.send_header("Content-type", "application/json")
                self.send_header("Access-Control-Allow-Origin", "*")
                self.end_headers()
                
                self.wfile.write(json.dumps({"error": error_msg}).encode("utf-8"))

        else:
            # Handle other request types
            self.send_response(405)
            self.send_header("Content-type", "application/json")
            self.send_header("Access-Control-Allow-Origin", "*")
            self.end_headers()
            self.wfile.write(json.dumps({"error": "Method not allowed"}).encode("utf-8"))

    def do_OPTIONS(self):
        """Handle CORS preflight requests"""
        self.send_response(200)
        self.send_header("Access-Control-Allow-Origin", "*")
        self.send_header("Access-Control-Allow-Methods", "GET, POST, OPTIONS")
        self.send_header("Access-Control-Allow-Headers", "Content-Type")
        self.end_headers()

def display_config():
    """Display current configuration with FIRE styling"""
    primary_model = PEACOCK_MODEL_STRATEGY.get('primary_model', 'llama-4-maverick-17b-128e-instruct')
    speed_model = PEACOCK_MODEL_STRATEGY.get('speed_model', 'llama-4-scout-17b-16e-instruct')
    
    print(f"\033[1;92mğŸ”§ Primary Model:\033[0m \033[1;97m{primary_model}\033[0m")
    print(f"\033[1;93mâš¡ Speed Model:\033[0m \033[1;97m{speed_model}\033[0m") 
    print(f"\033[1;95mğŸ§  Strategy:\033[0m \033[1;96mBird-Specific API Keys + Proxy Fallback\033[0m")
    print(f"\033[1;94mğŸ“… Session:\033[0m \033[1;97m{SESSION_TIMESTAMP}\033[0m")
    print(f"\033[1;91mğŸ“Š Logging:\033[0m \033[1;{'92' if LOGGING_ENABLED else '31'}m{'Enabled' if LOGGING_ENABLED else 'Disabled'}\033[0m")
    print(f"\033[1;96mğŸ“ Log Directory:\033[0m \033[1;97m/home/flintx/peacock/logs\033[0m")
    print()

def main():
    """Main function with argument parsing and FIRE visuals"""
    global LOGGING_ENABLED
    
    parser = argparse.ArgumentParser(description='ğŸ¦š Peacock MCP Server - Multi-Model Optimized')
    parser.add_argument('--log', '-l', action='store_true', help='Enable comprehensive logging')
    parser.add_argument('--port', '-p', type=int, default=8000, help='Server port (default: 8000)')
    
    args = parser.parse_args()
    
    LOGGING_ENABLED = args.log
    server_port = args.port
    
    # Initialize logging
    init_logging()
    
    # Display styled config
    display_config()
    
    # Clean server startup display
    print("â”â”â”â”â”â”â”â”â”â”â”â€¢â…â€¢Â°â€¢âˆâ€¢Â°â€¢â…â€¢â”â”â”â”â”â”â”â”â”â”â”â”“")
    print(f"ğŸŒ Server starting on http://{HOST}:{server_port}")
    print("â”—â”â”â”â”â”â”â”â”â”â”â€¢â…â€¢Â°â€¢âˆâ€¢Â°â€¢â…â€¢â”â”â”â”â”â”â”â”â”â”â”â”›")
    print()
    print("â”â”â”â”â”â”â€¢â…â€¢Â°â€¢âˆâ€¢Â°â€¢â…â€¢â”â”â”â”â”â”“")
    print("   âœ… Wire #1: WebUI â†’ MCP")
    print("   âœ… Wire #2: MCP â†’ Birds")
    print("   âœ… Wire #3: Birds â†’ LLM")
    print("   âœ… Wire #4: LLM â†’ XEdit")
    print("   âœ… PCOCK Deploy: Ready")
    print("â”—â”â”â”â”â”â€¢â…â€¢Â°â€¢âˆâ€¢Â°â€¢â…â€¢â”â”â”â”â”â”›")
    print()
    
    print(f"\033[1;42m\033[1;30m ğŸ¦š PEACOCK SERVER READY! \033[0m")
    print("\033[1;32m" + "=" * 80 + "\033[0m")
    print()
    
    try:
        with socketserver.TCPServer((HOST, server_port), PeacockRequestHandler) as httpd:
            httpd.serve_forever()
    except KeyboardInterrupt:
        print("\nğŸ›‘ Peacock MCP Server shutdown complete")
    except Exception as e:
        print(f"âŒ Server error: {e}")

if __name__ == "__main__":
    main()

#â…›Â¼â…œÂ½ END OF DOCUMENT â…Â¾â…#
```

That's the CLEAN version with all the FIRE styling you want! The key fixes:

1. **Fixed global declaration** - only `LOGGING_ENABLED`, using local `server_port`
2. **Added the styled display_config()** function with colored model display
3. **Clean wire status display** with the fancy borders
4. **No duplicate/broken code**

This should run smooth and look SICK! ğŸ”¥ğŸ¦š

