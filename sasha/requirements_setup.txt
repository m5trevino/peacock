# requirements.txt
haralyzer==1.8.0
rich==13.7.0
click==8.1.7

# setup.py
from setuptools import setup, find_packages

setup(
    name="api-security-scanner",
    version="1.0.0",
    description="API Security Analysis Tool - HAR to Intelligence Pipeline",
    author="Street Smart Security",
    packages=find_packages(),
    install_requires=[
        "haralyzer>=1.8.0",
        "rich>=13.0.0",
        "click>=8.0.0"
    ],
    entry_points={
        'console_scripts': [
            'api-scan=api_security_tool:main',
        ],
    },
    python_requires=">=3.8",
    classifiers=[
        "Development Status :: 4 - Beta",
        "Intended Audience :: Information Technology",
        "Topic :: Security",
        "Programming Language :: Python :: 3.8",
        "Programming Language :: Python :: 3.9",
        "Programming Language :: Python :: 3.10",
        "Programming Language :: Python :: 3.11",
    ]
)

# install.sh
#!/bin/bash
# Installation script for API Security Scanner

echo "ğŸ”§ Setting up API Security Scanner..."

# Create virtual environment
python3 -m venv venv
source venv/bin/activate

# Install dependencies
pip install --upgrade pip
pip install -r requirements.txt

echo "âœ… Installation complete!"
echo ""
echo "Usage:"
echo "  source venv/bin/activate"
echo "  python api_security_tool.py your_file.har"
echo ""
echo "Options:"
echo "  --export-json          Export detailed JSON report"
echo "  --export-wordlists     Export fuzzing wordlists"
echo "  --output DIR           Set output directory"
echo "  --quiet               Minimal terminal output"

# README.md
# API Security Scanner

**Transform HAR files into actionable security intelligence**

## ğŸ¯ What This Tool Does

This tool bridges the gap between traffic interception (HTTP Toolkit, Burp Suite) and actionable security analysis. Drop in a HAR file, get out:

- **Secrets & Token Detection** - JWT tokens, API keys, auth tokens
- **Authentication Mapping** - Login flows, OAuth endpoints, session handling  
- **Vulnerability Leads** - SQL injection hints, XSS reflection points, IDOR candidates
- **Endpoint Intelligence** - Complete API mapping with high-value target identification
- **Security Assessment** - Missing headers, weak configurations
- **Fuzzing Wordlists** - Ready-to-use lists for endpoint discovery

## ğŸš€ Quick Start

```bash
# Install dependencies
pip install haralyzer rich

# Basic scan
python api_security_tool.py captured_traffic.har

# Full analysis with exports
python api_security_tool.py captured_traffic.har --export-json --export-wordlists --output ./results
```

## ğŸ“Š Sample Output

```
ğŸ¯ API Security Analysis Summary
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”“
â”ƒ Metric           â”ƒ Count â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”©
â”‚ Total Requests   â”‚   847 â”‚
â”‚ Unique Domains   â”‚     3 â”‚
â”‚ Unique Endpoints â”‚   156 â”‚
â”‚ Security Findingsâ”‚    23 â”‚
â”‚ Secrets Found    â”‚     7 â”‚
â”‚ Auth Endpoints   â”‚    12 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”˜

ğŸ” Secrets & Tokens Found
â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”³â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ Type       â”ƒ Location â”ƒ URL                                              â”ƒ Confidence â”ƒ
â”¡â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â•‡â”â”â”â”â”â”â”â”â”â”â”â”â”©
â”‚ jwt_token  â”‚ headers  â”‚ https://api.example.com/v1/user/profile         â”‚ high       â”‚
â”‚ api_key    â”‚ url_paramsâ”‚ https://api.example.com/search?key=sk_live_abc...â”‚ medium     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ Use Cases

### Bug Bounty Hunting
- Intercept app traffic with HTTP Toolkit
- Feed HAR file to this tool
- Get prioritized list of security leads
- Focus testing on high-value endpoints

### Penetration Testing  
- Comprehensive API surface mapping
- Automated secrets detection
- Generate custom wordlists for fuzzing
- Identify authentication bypass opportunities

### Security Assessment
- Audit API security posture
- Detect exposed secrets in traffic
- Map