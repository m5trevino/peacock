{
  "inputs": {
    "spark": "",
    "falcon": "SPARK – LIVE-CIRCUIT VISUAL LANGUAGE  \n(Everything below is copy-paste ready for Tailwind + Framer-Motion)\n\n-------------------------------------------------\n1. ROOT TOKENS (Tailwind plugin)\n-------------------------------------------------\n// tailwind.config.js\nconst colors = require('tailwindcss/colors')\n\nmodule.exports = {\n  content: ['./src/**/*.{js,ts,jsx,tsx}'],\n  theme: {\n    extend: {\n      colors: {\n        void: '#050505',\n        'matrix-green': '#00FF41',\n        'alert-red': '#FF3B30',\n        'processing-yellow': '#FFCC00',\n      },\n      fontFamily: {\n        mono: ['JetBrains Mono', 'monospace'],\n      },\n      boxShadow: {\n        'glow-green': '0 0 6px #00FF41, 0 0 12px #00FF41',\n        'glow-red': '0 0 6px #FF3B30, 0 0 12px #FF3B30',\n        'glow-yellow': '0 0 6px #FFCC00, 0 0 12px #FFCC00',\n      },\n      animation: {\n        'pulse-green': 'pulse-green 1.2s ease-in-out infinite',\n        'pulse-red': 'pulse-red .6s ease-in-out infinite',\n        'flow': 'flow 1s linear infinite',\n        'scanline': 'scanline 8s linear infinite',\n        'blink': 'blink 1s steps(2, start) infinite',\n      },\n      keyframes: {\n        'pulse-green': { '0%,100%': { opacity: 1 }, '50%': { opacity: .4 } },\n        'pulse-red': { '0%,100%': { opacity: 1 }, '50%': { opacity: .2 } },\n        'flow': { to: { strokeDashoffset: -20 } },\n        'scanline': { '0%': { transform: 'translateY(-100%)' }, '100%': { transform: 'translateY(100%)' } },\n        'blink': { to: { visibility: 'hidden' } },\n      },\n    },\n  },\n  plugins: [],\n}\n\n-------------------------------------------------\n2. BASE LAYER (global.css)\n-------------------------------------------------\n@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n@layer base {\n  body {\n    @apply bg-void text-matrix-green font-mono text-xs leading-none antialiased;\n    text-rendering: optimizeSpeed;\n  }\n  /* CRT mask */\n  body::after {\n    content: '';\n    position: fixed;\n    inset: 0;\n    pointer-events: none;\n    background: linear-gradient(rgba(18,16,16,0) 50%, rgba(0,0,0,0.25) 50%);\n    background-size: 100% 2px;\n    animation: scanline 8s linear infinite;\n    z-index: 100;\n  }\n}\n\n-------------------------------------------------\n3. REACT COMPONENTS\n-------------------------------------------------\n// Wire.tsx – the actual “nervous-system” line\nimport { motion } from 'framer-motion'\n\ntype WireState = 'idle' | 'success' | 'failure' | 'processing'\n\nconst Wire: React.FC<{ state: WireState }> = ({ state }) => {\n  const pathVariants = {\n    idle: { pathLength: 1, opacity: .3, stroke: '#00FF41' },\n    success: { pathLength: 1, opacity: 1, stroke: '#00FF41' },\n    failure: { pathLength: 1, opacity: [1, 0, 1], stroke: '#FF3B30' },\n    processing: { pathLength: 1, strokeDasharray: '4 4', stroke: '#FFCC00' },\n  }\n\n  return (\n    <svg className=\"absolute inset-0 w-full h-full pointer-events-none\">\n      <motion.path\n        d=\"M0 50 L100 50\"\n        variants={pathVariants}\n        animate={state}\n        transition={{\n          duration: .6,\n          repeat: state === 'processing' ? Infinity : 0,\n          repeatType: 'loop',\n        }}\n        className=\"drop-shadow-glow\"\n        strokeWidth=\"2\"\n        strokeLinecap=\"round\"\n      />\n    </svg>\n  )\n}\n\n-------------------------------------------------\n4. TEXT MODULE (with blinking cursor)\n-------------------------------------------------\nconst ConsoleLine: React.FC<{ children: string }> = ({ children }) => (\n  <div className=\"flex items-baseline\">\n    <span className=\"text-matrix-green\">{children}</span>\n    <span className=\"inline-block w-2 h-3 ml-1 bg-matrix-green animate-blink\" />\n  </div>\n)\n\n-------------------------------------------------\n5. USAGE EXAMPLE\n-------------------------------------------------\nexport default function LiveCircuit() {\n  const [wire, setWire] = useState<'idle' | 'success' | 'failure' | 'processing'>('idle')\n\n  return (\n    <div className=\"relative w-full h-screen bg-void overflow-hidden\">\n      {/* HUD frame */}\n      <div className=\"absolute inset-4 border border-matrix-green/30 rounded-none p-4\">\n        <ConsoleLine>scanning subsystem…</ConsoleLine>\n      </div>\n\n      {/* Nervous system */}\n      <Wire state={wire} />\n\n      {/* Demo buttons */}\n      <div className=\"absolute bottom-8 left-8 space-x-2\">\n        <button onClick={() => setWire('success')} className=\"px-3 py-1 bg-matrix-green/20 border border-matrix-green text-matrix-green\">Success</button>\n        <button onClick={() => setWire('failure')} className=\"px-3 py-1 bg-alert-red/20 border border-alert-red text-alert-red\">Failure</button>\n        <button onClick={() => setWire('processing')} className=\"px-3 py-1 bg-processing-yellow/20 border border-processing-yellow text-processing-yellow\">Process</button>\n      </div>\n    </div>\n  )\n}\n\n-------------------------------------------------\n6. MOTION STATES CHEAT-SHEET\n-------------------------------------------------\nidle        → opacity .3, static green\nsuccess     → opacity 1, drop-shadow-glow-green\nfailure     → flashing opacity 1↔0, drop-shadow-glow-red\nprocessing  → strokeDasharray 4 4, drop-shadow-glow-yellow, infinite loop\n\n-------------------------------------------------\n7. PERFORMANCE NOTES\n-------------------------------------------------\n- SVG paths are GPU-accelerated; keep pathLength 1 to avoid layout thrash.\n- Use `will-change: opacity` only on failure flash to prevent jank.\n- CRT scanline is a single pseudo-element, 2 px high, GPU-friendly.\n\nCopy, paste, glitch.",
    "eagle": "Falcon here – below is the minimal surface area that lets the Interactive Blueprint render without ever blocking the main thread.\n\n--------------------------------------------------\n1.  GLOBAL STORE  (Zustand)\n--------------------------------------------------\n```ts\n// store/blueprint.store.ts\nimport { create } from 'zustand';\nimport { subscribeWithSelector } from 'zustand/middleware';\nimport { immer } from 'zustand/middleware/immer';\n\nexport type NodeStatus = 'Idle' | 'Loading' | 'Success' | 'Error';\n\nexport interface NodeMeta {\n  id: string;                       // unique inside blueprint\n  name: string;                     // human readable\n  inputs: string[];               // semantic names\n  outputs: string[];              // semantic names\n  states: string[];               // ordered micro-stages\n}\n\nexport interface NodeState {\n  meta: NodeMeta;\n  status: NodeStatus;\n  currentStateIdx: number;        // which micro-stage we are in\n  error?: string;\n}\n\ninterface BlueprintState {\n  nodes: Record<string, NodeState>;\n  setStatus: (nodeId: string, status: NodeStatus, error?: string) => void;\n  setMicroStage: (nodeId: string, idx: number) => void;\n  loadBlueprint: (nodes: NodeMeta[]) => void;\n}\n\nexport const useBlueprint = create<BlueprintState>()(\n  subscribeWithSelector(\n    immer((set) => ({\n      nodes: {},\n      setStatus: (id, status, error) =>\n        set((s) => {\n          if (s.nodes[id]) {\n            s.nodes[id].status = status;\n            s.nodes[id].error = error;\n            if (status === 'Loading') s.nodes[id].currentStateIdx = 0;\n          }\n        }),\n      setMicroStage: (id, idx) =>\n        set((s) => {\n          if (s.nodes[id]) s.nodes[id].currentStateIdx = idx;\n        }),\n      loadBlueprint: (metas) =>\n        set((s) => {\n          s.nodes = {};\n          metas.forEach((m) => (s.nodes[m.id] = { meta: m, status: 'Idle', currentStateIdx: 0 }));\n        }),\n    })),\n  ),\n);\n```\n\n--------------------------------------------------\n2.  PERSISTENCE LAYER  (Dexie + WebWorker)\n--------------------------------------------------\n```ts\n// db/worker.ts  (compiled to a separate chunk)\nimport { Dexie } from 'dexie';\n\nconst db = new Dexie('BlueprintDB');\ndb.version(1).stores({\n  nodes: 'id, meta, snapshot',   // snapshot = NodeState\n  logs: '++_, nodeId, ts, level, msg',\n});\n\nself.onmessage = async (e) => {\n  const { op, payload } = e.data;\n  switch (op) {\n    case 'persistState':\n      await db.nodes.put({ id: payload.id, meta: payload.meta, snapshot: payload });\n      break;\n    case 'loadBlueprint':\n      const all = await db.nodes.toArray();\n      self.postMessage({ op: 'loaded', payload: all.map((x) => x.snapshot) });\n      break;\n  }\n};\n```\n\n```ts\n// db/dexie.client.ts\nconst worker = new Worker(new URL('./worker.ts', import.meta.url), { type: 'module' });\n\nexport const persistState = (s: NodeState) =>\n  worker.postMessage({ op: 'persistState', payload: s });\n\nexport const loadPersisted = (): Promise<NodeState[]> =>\n  new Promise((res) => {\n    worker.onmessage = (e) => e.data.op === 'loaded' && res(e.data.payload);\n    worker.postMessage({ op: 'loadBlueprint' });\n  };\n```\n\n--------------------------------------------------\n3.  REACT HOOK THAT GLUES EVERYTHING\n--------------------------------------------------\n```ts\n// hooks/useBlueprintHydration.ts\nimport { useEffect } from 'react';\nimport { useBlueprint, NodeMeta } from '@/store/blueprint.store';\nimport { loadPersisted, persistState } from '@/db/dexie.client';\n\nexport const useBlueprintHydration = (initialMetas: NodeMeta[]) => {\n  const { nodes, loadBlueprint, setStatus, setMicroStage } = useBlueprint();\n\n  // bootstrap\n  useEffect(() => {\n    (async () => {\n      const saved = await loadPersisted();\n      if (saved.length) {\n        // rebuild store from IndexedDB\n        loadBlueprint(saved.map((s) => s.meta));\n      } else {\n        loadBlueprint(initialMetas);\n      }\n    })();\n  }, []);\n\n  // subscribe to every mutation and off-load to worker\n  useEffect(\n    () =>\n      useBlueprint.subscribe(\n        (s) => s.nodes,\n        (curr) => {\n          Object.values(curr).forEach((n) => persistState(n));\n        },\n        { equalityFn: (a, b) => JSON.stringify(a) === JSON.stringify(b) },\n      ),\n    [],\n  );\n\n  return { nodes, setStatus, setMicroStage };\n};\n```\n\n--------------------------------------------------\n4.  USAGE INSIDE REACT\n--------------------------------------------------\n```tsx\nconst initialMetas: NodeMeta[] = [\n  {\n    id: 'BATCH_PROCESSOR',\n    name: 'Batch Processor',\n    inputs: ['Files'],\n    outputs: ['IndexedDB'],\n    states: ['Parsing', 'Striking'],\n  },\n];\n\nexport const BlueprintCanvas = () => {\n  const { nodes, setStatus, setMicroStage } = useBlueprintHydration(initialMetas);\n\n  return (\n    <svg>\n      {Object.values(nodes).map((n) => (\n        <NodeWidget\n          key={n.meta.id}\n          meta={n.meta}\n          status={n.status}\n          microStage={n.currentStateIdx}\n          onTrigger={() => {\n            setStatus(n.meta.id, 'Loading');\n            // simulate work\n            setTimeout(() => setStatus(n.meta.id, 'Success'), 2000);\n          }}\n        />\n      ))}\n    </svg>\n  );\n};\n```\n\n--------------------------------------------------\n5.  STATE MACHINE SUMMARY\n--------------------------------------------------\n- Idle → Loading → (micro-stages 0..N) → Success | Error  \n- Every transition is a Zustand action → triggers React re-render → persisted off-thread via Dexie worker.  \n- Main thread never touches IndexedDB directly → UI stays @ 60 fps.\n\nThis is the complete data-flow skeleton – drop your own UI components on top.",
    "owl": "```typescript\n// src/components/debug/TestBench.tsx\ncat << 'EOF'\nimport React, { useState } from 'react';\nimport { apiCall, dbQuery, batchJob } from '../../lib/engine';\n\nexport const TestBench: React.FC = () => {\n  const [log, setLog] = useState<string[]>([]);\n\n  const append = (msg: string) => setLog(prev => [...prev, `[${new Date().toISOString()}] ${msg}`]);\n\n  const runApi = async () => {\n    append('API → start');\n    try {\n      const res = await apiCall('/health');\n      append(`API ← ${JSON.stringify(res)}`);\n    } catch (e: any) {\n      append(`API ✖ ${e.message}`);\n    }\n  };\n\n  const runDb = async () => {\n    append('DB → start');\n    try {\n      const rows = await dbQuery('SELECT 1 as ok');\n      append(`DB ← ${JSON.stringify(rows)}`);\n    } catch (e: any) {\n      append(`DB ✖ ${e.message}`);\n    }\n  };\n\n  const runBatch = async () => {\n    append('BATCH → start');\n    try {\n      const report = await batchJob('nightly');\n      append(`BATCH ← ${JSON.stringify(report)}`);\n    } catch (e: any) {\n      append(`BATCH ✖ ${e.message}`);\n    }\n  };\n\n  return (\n    <div className=\"p-4 bg-gray-900 text-gray-100 font-mono text-sm\">\n      <div className=\"flex gap-2 mb-3\">\n        <button onClick={runApi} className=\"px-3 py-1 bg-blue-600 rounded hover:bg-blue-500\">API</button>\n        <button onClick={runDb} className=\"px-3 py-1 bg-green-600 rounded hover:bg-green-500\">DB</button>\n        <button onClick={runBatch} className=\"px-3 py-1 bg-purple-600 rounded hover:bg-purple-500\">BATCH</button>\n      </div>\n      <div className=\"h-48 overflow-auto bg-black p-2 rounded border border-gray-700\">\n        {log.map((l, i) => (\n          <div key={i}>{l}</div>\n        ))}\n      </div>\n    </div>\n  );\n};\nEOF\n```\n\n```typescript\n// src/components/visual/CircuitBoard.tsx\ncat << 'EOF'\nimport React, { useEffect, useRef } from 'react';\nimport { useTestBench } from '../../hooks/useTestBench';\n\ntype Node = { id: string; x: number; y: number; label: string; type: 'api' | 'db' | 'batch' };\n\nexport const CircuitBoard: React.FC = () => {\n  const svgRef = useRef<SVGSVGElement>(null);\n  const { lastEvent } = useTestBench();\n\n  const nodes: Node[] = [\n    { id: 'api', x: 100, y: 100, label: 'API', type: 'api' },\n    { id: 'db', x: 300, y: 100, label: 'DB', type: 'db' },\n    { id: 'batch', x: 200, y: 200, label: 'BATCH', type: 'batch' },\n  ];\n\n  useEffect(() => {\n    if (!lastEvent) return;\n    const el = svgRef.current?.querySelector(`#${lastEvent.type}`);\n    if (!el) return;\n    el.classList.add('animate-pulse');\n    setTimeout(() => el.classList.remove('animate-pulse'), 600);\n  }, [lastEvent]);\n\n  return (\n    <svg ref={svgRef} className=\"w-full h-full bg-gray-900\">\n      {/* Lines */}\n      <line x1={100} y1={100} x2={300} y2={100} stroke=\"#4ade80\" strokeWidth=\"2\" />\n      <line x1={200} y1={200} x2={100} y2={100} stroke=\"#60a5fa\" strokeWidth=\"2\" />\n      <line x1={200} y1={200} x2={300} y2={100} stroke=\"#c084fc\" strokeWidth=\"2\" />\n\n      {/* Nodes */}\n      {nodes.map(n => (\n        <g key={n.id} id={n.id} className=\"cursor-pointer\" onClick={() => window.dispatchEvent(new CustomEvent('blueprint:open', { detail: n }))}>\n          <circle cx={n.x} cy={n.y} r=\"24\" fill={n.type === 'api' ? '#2563eb' : n.type === 'db' ? '#16a34a' : '#9333ea'} />\n          <text x={n.x} y={n.y + 5} textAnchor=\"middle\" fill=\"#fff\" className=\"text-xs pointer-events-none\">{n.label}</text>\n        </g>\n      ))}\n    </svg>\n  );\n};\nEOF\n```\n\n```typescript\n// src/components/visual/BlueprintOverlay.tsx\ncat << 'EOF'\nimport React, { useEffect, useState } from 'react';\nimport { createPortal } from 'react-dom';\n\ntype Node = { id: string; label: string; type: 'api' | 'db' | 'batch' };\n\nexport const BlueprintOverlay: React.FC = () => {\n  const [node, setNode] = useState<Node | null>(null);\n\n  useEffect(() => {\n    const handler = (e: any) => setNode(e.detail);\n    window.addEventListener('blueprint:open', handler);\n    return () => window.removeEventListener('blueprint:open', handler);\n  }, []);\n\n  if (!node) return null;\n\n  const spec =\n    node.type === 'api'\n      ? 'GET /health → {status:ok}'\n      : node.type === 'db'\n      ? 'SELECT 1'\n      : 'node dist/jobs/nightly.js';\n\n  return createPortal(\n    <div className=\"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center\" onClick={() => setNode(null)}>\n      <div className=\"bg-gray-800 text-gray-100 p-6 rounded-lg w-96\" onClick={e => e.stopPropagation()}>\n        <h2 className=\"text-xl font-bold mb-2\">{node.label} Blueprint</h2>\n        <pre className=\"text-sm bg-gray-900 p-3 rounded\">{spec}</pre>\n        <button className=\"mt-4 px-3 py-1 bg-red-600 rounded hover:bg-red-500\" onClick={() => setNode(null)}>Close</button>\n      </div>\n    </div>,\n    document.body\n  );\n};\nEOF\n```",
    "hawk": ""
  },
  "outputs": {
    "spark": "SPARK – LIVE-CIRCUIT VISUAL LANGUAGE  \n(Everything below is copy-paste ready for Tailwind + Framer-Motion)\n\n-------------------------------------------------\n1. ROOT TOKENS (Tailwind plugin)\n-------------------------------------------------\n// tailwind.config.js\nconst colors = require('tailwindcss/colors')\n\nmodule.exports = {\n  content: ['./src/**/*.{js,ts,jsx,tsx}'],\n  theme: {\n    extend: {\n      colors: {\n        void: '#050505',\n        'matrix-green': '#00FF41',\n        'alert-red': '#FF3B30',\n        'processing-yellow': '#FFCC00',\n      },\n      fontFamily: {\n        mono: ['JetBrains Mono', 'monospace'],\n      },\n      boxShadow: {\n        'glow-green': '0 0 6px #00FF41, 0 0 12px #00FF41',\n        'glow-red': '0 0 6px #FF3B30, 0 0 12px #FF3B30',\n        'glow-yellow': '0 0 6px #FFCC00, 0 0 12px #FFCC00',\n      },\n      animation: {\n        'pulse-green': 'pulse-green 1.2s ease-in-out infinite',\n        'pulse-red': 'pulse-red .6s ease-in-out infinite',\n        'flow': 'flow 1s linear infinite',\n        'scanline': 'scanline 8s linear infinite',\n        'blink': 'blink 1s steps(2, start) infinite',\n      },\n      keyframes: {\n        'pulse-green': { '0%,100%': { opacity: 1 }, '50%': { opacity: .4 } },\n        'pulse-red': { '0%,100%': { opacity: 1 }, '50%': { opacity: .2 } },\n        'flow': { to: { strokeDashoffset: -20 } },\n        'scanline': { '0%': { transform: 'translateY(-100%)' }, '100%': { transform: 'translateY(100%)' } },\n        'blink': { to: { visibility: 'hidden' } },\n      },\n    },\n  },\n  plugins: [],\n}\n\n-------------------------------------------------\n2. BASE LAYER (global.css)\n-------------------------------------------------\n@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n@layer base {\n  body {\n    @apply bg-void text-matrix-green font-mono text-xs leading-none antialiased;\n    text-rendering: optimizeSpeed;\n  }\n  /* CRT mask */\n  body::after {\n    content: '';\n    position: fixed;\n    inset: 0;\n    pointer-events: none;\n    background: linear-gradient(rgba(18,16,16,0) 50%, rgba(0,0,0,0.25) 50%);\n    background-size: 100% 2px;\n    animation: scanline 8s linear infinite;\n    z-index: 100;\n  }\n}\n\n-------------------------------------------------\n3. REACT COMPONENTS\n-------------------------------------------------\n// Wire.tsx – the actual “nervous-system” line\nimport { motion } from 'framer-motion'\n\ntype WireState = 'idle' | 'success' | 'failure' | 'processing'\n\nconst Wire: React.FC<{ state: WireState }> = ({ state }) => {\n  const pathVariants = {\n    idle: { pathLength: 1, opacity: .3, stroke: '#00FF41' },\n    success: { pathLength: 1, opacity: 1, stroke: '#00FF41' },\n    failure: { pathLength: 1, opacity: [1, 0, 1], stroke: '#FF3B30' },\n    processing: { pathLength: 1, strokeDasharray: '4 4', stroke: '#FFCC00' },\n  }\n\n  return (\n    <svg className=\"absolute inset-0 w-full h-full pointer-events-none\">\n      <motion.path\n        d=\"M0 50 L100 50\"\n        variants={pathVariants}\n        animate={state}\n        transition={{\n          duration: .6,\n          repeat: state === 'processing' ? Infinity : 0,\n          repeatType: 'loop',\n        }}\n        className=\"drop-shadow-glow\"\n        strokeWidth=\"2\"\n        strokeLinecap=\"round\"\n      />\n    </svg>\n  )\n}\n\n-------------------------------------------------\n4. TEXT MODULE (with blinking cursor)\n-------------------------------------------------\nconst ConsoleLine: React.FC<{ children: string }> = ({ children }) => (\n  <div className=\"flex items-baseline\">\n    <span className=\"text-matrix-green\">{children}</span>\n    <span className=\"inline-block w-2 h-3 ml-1 bg-matrix-green animate-blink\" />\n  </div>\n)\n\n-------------------------------------------------\n5. USAGE EXAMPLE\n-------------------------------------------------\nexport default function LiveCircuit() {\n  const [wire, setWire] = useState<'idle' | 'success' | 'failure' | 'processing'>('idle')\n\n  return (\n    <div className=\"relative w-full h-screen bg-void overflow-hidden\">\n      {/* HUD frame */}\n      <div className=\"absolute inset-4 border border-matrix-green/30 rounded-none p-4\">\n        <ConsoleLine>scanning subsystem…</ConsoleLine>\n      </div>\n\n      {/* Nervous system */}\n      <Wire state={wire} />\n\n      {/* Demo buttons */}\n      <div className=\"absolute bottom-8 left-8 space-x-2\">\n        <button onClick={() => setWire('success')} className=\"px-3 py-1 bg-matrix-green/20 border border-matrix-green text-matrix-green\">Success</button>\n        <button onClick={() => setWire('failure')} className=\"px-3 py-1 bg-alert-red/20 border border-alert-red text-alert-red\">Failure</button>\n        <button onClick={() => setWire('processing')} className=\"px-3 py-1 bg-processing-yellow/20 border border-processing-yellow text-processing-yellow\">Process</button>\n      </div>\n    </div>\n  )\n}\n\n-------------------------------------------------\n6. MOTION STATES CHEAT-SHEET\n-------------------------------------------------\nidle        → opacity .3, static green\nsuccess     → opacity 1, drop-shadow-glow-green\nfailure     → flashing opacity 1↔0, drop-shadow-glow-red\nprocessing  → strokeDasharray 4 4, drop-shadow-glow-yellow, infinite loop\n\n-------------------------------------------------\n7. PERFORMANCE NOTES\n-------------------------------------------------\n- SVG paths are GPU-accelerated; keep pathLength 1 to avoid layout thrash.\n- Use `will-change: opacity` only on failure flash to prevent jank.\n- CRT scanline is a single pseudo-element, 2 px high, GPU-friendly.\n\nCopy, paste, glitch.",
    "falcon": "Falcon here – below is the minimal surface area that lets the Interactive Blueprint render without ever blocking the main thread.\n\n--------------------------------------------------\n1.  GLOBAL STORE  (Zustand)\n--------------------------------------------------\n```ts\n// store/blueprint.store.ts\nimport { create } from 'zustand';\nimport { subscribeWithSelector } from 'zustand/middleware';\nimport { immer } from 'zustand/middleware/immer';\n\nexport type NodeStatus = 'Idle' | 'Loading' | 'Success' | 'Error';\n\nexport interface NodeMeta {\n  id: string;                       // unique inside blueprint\n  name: string;                     // human readable\n  inputs: string[];               // semantic names\n  outputs: string[];              // semantic names\n  states: string[];               // ordered micro-stages\n}\n\nexport interface NodeState {\n  meta: NodeMeta;\n  status: NodeStatus;\n  currentStateIdx: number;        // which micro-stage we are in\n  error?: string;\n}\n\ninterface BlueprintState {\n  nodes: Record<string, NodeState>;\n  setStatus: (nodeId: string, status: NodeStatus, error?: string) => void;\n  setMicroStage: (nodeId: string, idx: number) => void;\n  loadBlueprint: (nodes: NodeMeta[]) => void;\n}\n\nexport const useBlueprint = create<BlueprintState>()(\n  subscribeWithSelector(\n    immer((set) => ({\n      nodes: {},\n      setStatus: (id, status, error) =>\n        set((s) => {\n          if (s.nodes[id]) {\n            s.nodes[id].status = status;\n            s.nodes[id].error = error;\n            if (status === 'Loading') s.nodes[id].currentStateIdx = 0;\n          }\n        }),\n      setMicroStage: (id, idx) =>\n        set((s) => {\n          if (s.nodes[id]) s.nodes[id].currentStateIdx = idx;\n        }),\n      loadBlueprint: (metas) =>\n        set((s) => {\n          s.nodes = {};\n          metas.forEach((m) => (s.nodes[m.id] = { meta: m, status: 'Idle', currentStateIdx: 0 }));\n        }),\n    })),\n  ),\n);\n```\n\n--------------------------------------------------\n2.  PERSISTENCE LAYER  (Dexie + WebWorker)\n--------------------------------------------------\n```ts\n// db/worker.ts  (compiled to a separate chunk)\nimport { Dexie } from 'dexie';\n\nconst db = new Dexie('BlueprintDB');\ndb.version(1).stores({\n  nodes: 'id, meta, snapshot',   // snapshot = NodeState\n  logs: '++_, nodeId, ts, level, msg',\n});\n\nself.onmessage = async (e) => {\n  const { op, payload } = e.data;\n  switch (op) {\n    case 'persistState':\n      await db.nodes.put({ id: payload.id, meta: payload.meta, snapshot: payload });\n      break;\n    case 'loadBlueprint':\n      const all = await db.nodes.toArray();\n      self.postMessage({ op: 'loaded', payload: all.map((x) => x.snapshot) });\n      break;\n  }\n};\n```\n\n```ts\n// db/dexie.client.ts\nconst worker = new Worker(new URL('./worker.ts', import.meta.url), { type: 'module' });\n\nexport const persistState = (s: NodeState) =>\n  worker.postMessage({ op: 'persistState', payload: s });\n\nexport const loadPersisted = (): Promise<NodeState[]> =>\n  new Promise((res) => {\n    worker.onmessage = (e) => e.data.op === 'loaded' && res(e.data.payload);\n    worker.postMessage({ op: 'loadBlueprint' });\n  };\n```\n\n--------------------------------------------------\n3.  REACT HOOK THAT GLUES EVERYTHING\n--------------------------------------------------\n```ts\n// hooks/useBlueprintHydration.ts\nimport { useEffect } from 'react';\nimport { useBlueprint, NodeMeta } from '@/store/blueprint.store';\nimport { loadPersisted, persistState } from '@/db/dexie.client';\n\nexport const useBlueprintHydration = (initialMetas: NodeMeta[]) => {\n  const { nodes, loadBlueprint, setStatus, setMicroStage } = useBlueprint();\n\n  // bootstrap\n  useEffect(() => {\n    (async () => {\n      const saved = await loadPersisted();\n      if (saved.length) {\n        // rebuild store from IndexedDB\n        loadBlueprint(saved.map((s) => s.meta));\n      } else {\n        loadBlueprint(initialMetas);\n      }\n    })();\n  }, []);\n\n  // subscribe to every mutation and off-load to worker\n  useEffect(\n    () =>\n      useBlueprint.subscribe(\n        (s) => s.nodes,\n        (curr) => {\n          Object.values(curr).forEach((n) => persistState(n));\n        },\n        { equalityFn: (a, b) => JSON.stringify(a) === JSON.stringify(b) },\n      ),\n    [],\n  );\n\n  return { nodes, setStatus, setMicroStage };\n};\n```\n\n--------------------------------------------------\n4.  USAGE INSIDE REACT\n--------------------------------------------------\n```tsx\nconst initialMetas: NodeMeta[] = [\n  {\n    id: 'BATCH_PROCESSOR',\n    name: 'Batch Processor',\n    inputs: ['Files'],\n    outputs: ['IndexedDB'],\n    states: ['Parsing', 'Striking'],\n  },\n];\n\nexport const BlueprintCanvas = () => {\n  const { nodes, setStatus, setMicroStage } = useBlueprintHydration(initialMetas);\n\n  return (\n    <svg>\n      {Object.values(nodes).map((n) => (\n        <NodeWidget\n          key={n.meta.id}\n          meta={n.meta}\n          status={n.status}\n          microStage={n.currentStateIdx}\n          onTrigger={() => {\n            setStatus(n.meta.id, 'Loading');\n            // simulate work\n            setTimeout(() => setStatus(n.meta.id, 'Success'), 2000);\n          }}\n        />\n      ))}\n    </svg>\n  );\n};\n```\n\n--------------------------------------------------\n5.  STATE MACHINE SUMMARY\n--------------------------------------------------\n- Idle → Loading → (micro-stages 0..N) → Success | Error  \n- Every transition is a Zustand action → triggers React re-render → persisted off-thread via Dexie worker.  \n- Main thread never touches IndexedDB directly → UI stays @ 60 fps.\n\nThis is the complete data-flow skeleton – drop your own UI components on top.",
    "eagle": "```typescript\n// src/components/debug/TestBench.tsx\ncat << 'EOF'\nimport React, { useState } from 'react';\nimport { apiCall, dbQuery, batchJob } from '../../lib/engine';\n\nexport const TestBench: React.FC = () => {\n  const [log, setLog] = useState<string[]>([]);\n\n  const append = (msg: string) => setLog(prev => [...prev, `[${new Date().toISOString()}] ${msg}`]);\n\n  const runApi = async () => {\n    append('API → start');\n    try {\n      const res = await apiCall('/health');\n      append(`API ← ${JSON.stringify(res)}`);\n    } catch (e: any) {\n      append(`API ✖ ${e.message}`);\n    }\n  };\n\n  const runDb = async () => {\n    append('DB → start');\n    try {\n      const rows = await dbQuery('SELECT 1 as ok');\n      append(`DB ← ${JSON.stringify(rows)}`);\n    } catch (e: any) {\n      append(`DB ✖ ${e.message}`);\n    }\n  };\n\n  const runBatch = async () => {\n    append('BATCH → start');\n    try {\n      const report = await batchJob('nightly');\n      append(`BATCH ← ${JSON.stringify(report)}`);\n    } catch (e: any) {\n      append(`BATCH ✖ ${e.message}`);\n    }\n  };\n\n  return (\n    <div className=\"p-4 bg-gray-900 text-gray-100 font-mono text-sm\">\n      <div className=\"flex gap-2 mb-3\">\n        <button onClick={runApi} className=\"px-3 py-1 bg-blue-600 rounded hover:bg-blue-500\">API</button>\n        <button onClick={runDb} className=\"px-3 py-1 bg-green-600 rounded hover:bg-green-500\">DB</button>\n        <button onClick={runBatch} className=\"px-3 py-1 bg-purple-600 rounded hover:bg-purple-500\">BATCH</button>\n      </div>\n      <div className=\"h-48 overflow-auto bg-black p-2 rounded border border-gray-700\">\n        {log.map((l, i) => (\n          <div key={i}>{l}</div>\n        ))}\n      </div>\n    </div>\n  );\n};\nEOF\n```\n\n```typescript\n// src/components/visual/CircuitBoard.tsx\ncat << 'EOF'\nimport React, { useEffect, useRef } from 'react';\nimport { useTestBench } from '../../hooks/useTestBench';\n\ntype Node = { id: string; x: number; y: number; label: string; type: 'api' | 'db' | 'batch' };\n\nexport const CircuitBoard: React.FC = () => {\n  const svgRef = useRef<SVGSVGElement>(null);\n  const { lastEvent } = useTestBench();\n\n  const nodes: Node[] = [\n    { id: 'api', x: 100, y: 100, label: 'API', type: 'api' },\n    { id: 'db', x: 300, y: 100, label: 'DB', type: 'db' },\n    { id: 'batch', x: 200, y: 200, label: 'BATCH', type: 'batch' },\n  ];\n\n  useEffect(() => {\n    if (!lastEvent) return;\n    const el = svgRef.current?.querySelector(`#${lastEvent.type}`);\n    if (!el) return;\n    el.classList.add('animate-pulse');\n    setTimeout(() => el.classList.remove('animate-pulse'), 600);\n  }, [lastEvent]);\n\n  return (\n    <svg ref={svgRef} className=\"w-full h-full bg-gray-900\">\n      {/* Lines */}\n      <line x1={100} y1={100} x2={300} y2={100} stroke=\"#4ade80\" strokeWidth=\"2\" />\n      <line x1={200} y1={200} x2={100} y2={100} stroke=\"#60a5fa\" strokeWidth=\"2\" />\n      <line x1={200} y1={200} x2={300} y2={100} stroke=\"#c084fc\" strokeWidth=\"2\" />\n\n      {/* Nodes */}\n      {nodes.map(n => (\n        <g key={n.id} id={n.id} className=\"cursor-pointer\" onClick={() => window.dispatchEvent(new CustomEvent('blueprint:open', { detail: n }))}>\n          <circle cx={n.x} cy={n.y} r=\"24\" fill={n.type === 'api' ? '#2563eb' : n.type === 'db' ? '#16a34a' : '#9333ea'} />\n          <text x={n.x} y={n.y + 5} textAnchor=\"middle\" fill=\"#fff\" className=\"text-xs pointer-events-none\">{n.label}</text>\n        </g>\n      ))}\n    </svg>\n  );\n};\nEOF\n```\n\n```typescript\n// src/components/visual/BlueprintOverlay.tsx\ncat << 'EOF'\nimport React, { useEffect, useState } from 'react';\nimport { createPortal } from 'react-dom';\n\ntype Node = { id: string; label: string; type: 'api' | 'db' | 'batch' };\n\nexport const BlueprintOverlay: React.FC = () => {\n  const [node, setNode] = useState<Node | null>(null);\n\n  useEffect(() => {\n    const handler = (e: any) => setNode(e.detail);\n    window.addEventListener('blueprint:open', handler);\n    return () => window.removeEventListener('blueprint:open', handler);\n  }, []);\n\n  if (!node) return null;\n\n  const spec =\n    node.type === 'api'\n      ? 'GET /health → {status:ok}'\n      : node.type === 'db'\n      ? 'SELECT 1'\n      : 'node dist/jobs/nightly.js';\n\n  return createPortal(\n    <div className=\"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center\" onClick={() => setNode(null)}>\n      <div className=\"bg-gray-800 text-gray-100 p-6 rounded-lg w-96\" onClick={e => e.stopPropagation()}>\n        <h2 className=\"text-xl font-bold mb-2\">{node.label} Blueprint</h2>\n        <pre className=\"text-sm bg-gray-900 p-3 rounded\">{spec}</pre>\n        <button className=\"mt-4 px-3 py-1 bg-red-600 rounded hover:bg-red-500\" onClick={() => setNode(null)}>Close</button>\n      </div>\n    </div>,\n    document.body\n  );\n};\nEOF\n```",
    "owl": "",
    "hawk": ""
  },
  "telemetry": {
    "spark": {
      "status": "success"
    },
    "falcon": {
      "status": "success"
    },
    "eagle": {
      "status": "success"
    },
    "owl": {
      "status": "idle"
    },
    "hawk": {
      "status": "idle"
    }
  },
  "activePrompts": {
    "spark": "02_spark_design",
    "falcon": "03_falcon_architecture",
    "eagle": "04_eagle_implementation",
    "owl": "owl_v21",
    "hawk": "05_hawk_qa"
  },
  "owlQueue": [],
  "name": "AVIARY_INIT",
  "id": "OP_1768627617510"
}